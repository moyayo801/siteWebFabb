<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="assets/images/logo3.png">
    <title>Gestion F.A.B.B - Médias</title>

    <!-- Bootstrap core CSS -->
    
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <!-- Additional CSS Files -->

 
  
    <link rel="stylesheet" href="assets/css/fontawesome.css">
    <link rel="stylesheet" href="assets/css/templatemo-574-mexant.css">
    <link rel="stylesheet" href="assets/css/owl.css">
    <link rel="stylesheet" href="assets/css/animate.css">  
 	<link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"> 
    <style>
i{
    position: absolute;
    top: 69%;
    right: 86%;
    transform: translate(-50%,-50%);
    font-size: 20px;
    color: #ff511a;
    transition: .2s;
    padding-top: 15%;
}
.boxx:hover i{
  
    opacity: 0;
    z-index: -1;
}
#myimg{
    height: 200px;
    width: 200px;
    border: 2px black solid;
}
.labs{
        display: inline-block;
        width: 100%;
      }

    </style>

  </head>

<body>


  <!-- ***** Header Area Start ***** -->
  <header class="header-area header-sticky">
      <div class="container">
          <div class="row">
              <div class="col-12">
                  <nav class="main-nav">
                      <!-- ***** Logo Start ***** -->
                      <a href="index.html" class="logo">
                          <img src="assets/images/logo3.png" alt="">
                      </a>
                      <!-- ***** Logo End ***** -->
                      <!-- ***** Menu Start ***** -->
                      <ul class="nav">
                          <li class="scroll-to-section"><a href="tables.html" class="active">Accueil</a></li>
                          <li class="has-sub">
                              <a href="javascript:void(0)">Menu</a>
                              <ul class="sub-menu">
                                  <li><a href="Joueurs.html">Joueurs</a></li>
                                  <li><a href="Matchs.html">Matchs</a></li>
                                  <li><a href="News.html">Actualités</a></li>
                                  <li><a href="Equipes.html">Équipe</a></li>
                                  <li><a href="entraineur.html">Entraîneurs</a></li>
                                  <li><a href="equipeNat.html">Sélection nationale</a></li>
                              </ul>
                          </li>
                          <li><a style="visibility: hidden;" href="contact-us.html">Contacts</a></li> 
                      </ul>        
                      <a class='menu-trigger'>
                          <span>Menu</span>
                      </a>
                      <!-- ***** Menu End ***** -->
                  </nav>
              </div>
          </div>
      </div>
  </header>
  <!-- ***** Header Area End ***** -->



  <!-- ***** Main Banner Area End ***** -->



 

   <section class="about-us" id="about">
    <div class="container">
      <div class="row">
        <div class="col-12 offset-lg-3">
          <div class="section-heading">
            
            <h4>Les Images / Videos</h4>
          </div>
        </div>
        <div class="col-12">
          <div class="naccs">
            <div class="tabs">
              <div class="row">
   
                <div class="col-lg-12">
                  <div class="menu">
                    <div class="active gradient-border"><span>Images</span></div>
                    <div class="gradient-border"><span>Vidéos</span></div>
                 
                  </div>
                </div>
              </div>
                <div class="col-lg-12">
                  <ul class="nacc">                       
                    <li class="active">
                      <div>
                        <div class="main-list">
                        <span>
                          <label>Titre de l'image</label><input type="text" id="namebox"><label id="extlab"></label> <br><br>
                          <div class="file-upload">
                            <button class="file-upload-btn" type="button" id="selbtn">Sélectionner une image</button>
                          
                            <div class="image-upload-wrap">
                              <div class="drag-text">
                                <h3>Sélectionner une image</h3>
                              </div>
                            </div>
                            <div class="file-upload-content">
                              <img id="myimg" class="file-upload-image" />
                              <label id="upprogress"></label>
                              <div class="image-title-wrap">
                                <button type="button" onclick="removeUpload()" class="remove-image">Enlever l'image <span class="image-title">Image enregistrée</span></button>
                              </div>
                            </div>
                            <button class="file-upload-btn" style="margin-top: 8%; background-color:rgb(26, 26, 89);" type="button" id="upbtn">Enregistrer l'image</button>
                          </div>
                    </span>
                </div>
          </div>
                    </li>
                    <li>
                      <div>
                        <div class="main-list">
                            <span> 
                              <label>Titre de la vidéo</label><input type="text" id="nameboxV"><label id="extlabV"></label> <br><br>
                              <div class="file-upload">
                                <button class="file-upload-btn" type="button" id="selbtnV">Sélectionner une vidéo</button>
                              
                                <div class="image-upload-wrap">
                                  <div class="drag-text">
                                    <h3>Sélectionner une vidéo</h3>
                                  </div>
                                </div>
                                <div class="file-upload-content">
                                  <video id="myimgV" class="file-upload-image" ></video>
                                  <label id="upprogressV"></label>
                                  <div class="image-title-wrap">
                                    <button type="button" onclick="removeUpload()" class="remove-image">Enlever</button>
                                  </div>
                                </div>
                                <button class="file-upload-btn" style="margin-top: 8%; background-color:rgb(26, 26, 89);" type="button" id="upbtnV">Enregistrer la vidéo</button>
                              </div>
    
                             </span>
                           
                        </div>
                      
                      </div>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>





   <footer>
    <div class="container">
      <div class="row">
    
      </div>
    </div>
  </footer>

  <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLongTitle">Remplir le formulaire</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
         
   <label class="labs">Club</label>                 <input id="clubbox" type="text" class="labs"></input> <br><br>     
   <label class="labs"> Date de fondation</label>  <input id="fondbox" type="text" class="labs"></input> <br><br>
   <label class="labs"> Défaites</label>          <input id="defaitesbox" type="number" class="labs"></input> <br><br>
   <label class="labs"> Entraineur</label>         <input id="entraineurbox" type="text" class="labs"></input> <br><br>
     <label class="labs">Nom</label>              <input id="nombox" type="text" class="labs"></input> <br><br>
     <label class="labs">Président</label>        <input id="presidentbox" type="text" class="labs"></input> <br><br>
      <label class="labs">Victoires</label>       <input id="victoiresbox" type="number" class="labs"></input> <br><br>
     <label class="labs">Ville</label>            <input id="villebox" type="text" class="labs"></input> <br><br> 
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" id="save">Save changes</button>
          <button type="button" class="btn btn-danger" id="drop">delete</button>
    
          <input type="hidden" name="index" id="index">
        </div>
      </div>
    </div>
  </div>
  <!-- Scripts -->
  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <script src="assets/js/isotope.min.js"></script>
  <script src="assets/js/owl-carousel.js"></script>
  <script src="assets/js/wow.js"></script>
  <script src="assets/js/tabs.js"></script>
  <script src="assets/js/swiper.js"></script>
  <script src="assets/js/custom.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script>
      var interleaveOffset = 0.5;

    var swiperOptions = {
      loop: true,
      speed: 1000,
      grabCursor: true,
      watchSlidesProgress: true,
      mousewheelControl: true,
      keyboardControl: true,
      navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev"
      },
      on: {
        progress: function() {
          var swiper = this;
          for (var i = 0; i < swiper.slides.length; i++) {
            var slideProgress = swiper.slides[i].progress;
            var innerOffset = swiper.width * interleaveOffset;
            var innerTranslate = slideProgress * innerOffset;
            swiper.slides[i].querySelector(".slide-inner").style.transform =
              "translate3d(" + innerTranslate + "px, 0, 0)";
          }      
        },
        touchStart: function() {
          var swiper = this;
          for (var i = 0; i < swiper.slides.length; i++) {
            swiper.slides[i].style.transition = "";
          }
        },
        setTransition: function(speed) {
          var swiper = this;
          for (var i = 0; i < swiper.slides.length; i++) {
            swiper.slides[i].style.transition = speed + "ms";
            swiper.slides[i].querySelector(".slide-inner").style.transition =
              speed + "ms";
          }
        }
      }
    };

    var swiper = new Swiper(".swiper-container", swiperOptions);
  </script>

<script>
function removeUpload() {
  $('.file-upload-input').replaceWith($('.file-upload-input').clone());
  $('.file-upload-content').hide();
  $('.image-upload-wrap').show();
}
$('.image-upload-wrap').bind('dragover', function () {
    $('.image-upload-wrap').addClass('image-dropping');
  });
  $('.image-upload-wrap').bind('dragleave', function () {
    $('.image-upload-wrap').removeClass('image-dropping');
});
</script>
<script type="module">
  
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.8/firebase-app.js";
   import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.8/firebase-analytics.js";
 
   const firebaseConfig = {
     apiKey: "AIzaSyAVpkaI_1x5d4ItI4kaiN2xOxPmXH_wjnE",
     authDomain: "yatosama-demo.firebaseapp.com",
     databaseURL: "https://yatosama-demo-default-rtdb.europe-west1.firebasedatabase.app",
     projectId: "yatosama-demo",
     storageBucket: "yatosama-demo.appspot.com",
     messagingSenderId: "440036821979",
     appId: "1:440036821979:web:0436e491278d04d78375fe",
     measurementId: "G-4XHSQ4HZXZ"
   };
 
   // Initialize Firebase
   const app = initializeApp(firebaseConfig);
   const analytics = getAnalytics(app);
 
   import{
    Timestamp, getFirestore, doc, onSnapshot, getDoc, setDoc, collection, addDoc, updateDoc, deleteDoc, deleteField, query, where , getDocs,
   }
   from "https://www.gstatic.com/firebasejs/9.6.8/firebase-firestore.js";
   import{
        getStorage, ref as sRef, uploadBytesResumable, getDownloadURL  }
   from "https://www.gstatic.com/firebasejs/9.6.8/firebase-storage.js";
 
  const db = getFirestore();
 //------------------------------------------------//
 var files =[];
var reader = new FileReader();


var namebox = document.getElementById('namebox');
var extlab = document.getElementById('extlab');
var myimg = document.getElementById('myimg');
var proglab = document.getElementById('upprogress');
var selbtn = document.getElementById('selbtn');
var upbtn = document.getElementById('upbtn');

var input = document.createElement('input');
input.type = 'file';
input.onchange = e => {
    files = e.target.files;

    var extention = GetFileExt(files[0]);
    var name = GetFileName(files[0]);

    namebox.value= name;
    extlab.innerHTML = extention;

    reader.readAsDataURL(files[0]);
}
reader.onload = function(e){
  $('.image-upload-wrap').hide();

$('.file-upload-image').attr('src', e.target.result);
$('.file-upload-content').show();

$('.image-title').html(input.files[0].name);
  myimg.src = reader.result;
}
/*----------------------------------------------*/

/*----------------------------------------------*/
selbtn.onclick = function () {
    input.click();
    
}
function GetFileExt(file) {
    var temp = file.name.split('.');
    var ext = temp.slice((temp.length-1),(temp.length));
    return '.' + ext[0];
}
function GetFileName(file) {
    var temp = file.name.split('.');
    var fname = temp.slice(0,-1).join('.');
    return fname;
}

/*----------------------------upload--------------------------*/
async function UploadProcess(){
    var ImgToUpload = files[0];
    var ImgName = namebox.value + extlab.innerHTML;

    const metaData = {
        contentType: ImgToUpload.type
    }

const storage = getStorage();

const storageRef = sRef(storage, "Images/"+ImgName);

const UploasTask = uploadBytesResumable(storageRef, ImgToUpload, metaData);

UploasTask.on('state-changed', (snapshot)=>{
    var progress = (snapshot.bytesTransferred / snapshot.totalBytes)* 100;
    proglab.innerHTML = "Upload "+ progress + "%";
},
(error) =>{
    alert("Erreur: l'image n'a pas pu être sauvegardée!!");
},

()=>{
    getDownloadURL(UploasTask.snapshot.ref).then((downloadURL)=>{
        SaveURLtoFirestore(downloadURL);
    });
}
);
}
/*-----------------------------------------------*/
async function SaveURLtoFirestore(url) {
    var name = namebox.value;
    const ho = new Date() ;
    var horairee = Timestamp.fromDate(ho);
    var ext = extlab.innerHTML;
    var ref = collection(db, "ImageLinks");

const docRef = await addDoc(
    ref,{
         Name: name,
         Horaire: horairee,
         URL : url
    }
)
}









upbtn.onclick = UploadProcess;
/*-------------------------------------------------------------------------*/


var nameboxV = document.getElementById('nameboxV');
var extlabV = document.getElementById('extlabV');
var myimgV = document.getElementById('myimgV');
var proglabV = document.getElementById('upprogressV');
var selbtnV = document.getElementById('selbtnV');
var upbtnV = document.getElementById('upbtnV');

var inputv = document.createElement('input');
inputv.type = 'file';
inputv.onchange = e => {
    files = e.target.files;

    var extention = GetFileExt(files[0]);
    var name = GetFileName(files[0]);

    nameboxV.value= name;
    extlabV.innerHTML = extention;

    reader.readAsDataURL(files[0]);
}
reader.onload = function(e){
  $('.image-upload-wrap').hide();

$('.file-upload-image').attr('src', e.target.result);
$('.file-upload-content').show();

$('.image-title').html(inputv.files[0].name);
  myimgV.src = reader.result;
}
/*----------------------------------------------*/

/*----------------------------------------------*/
selbtnV.onclick = function () {
    inputv.click();
    
}
function GetFileExtV(file) {
    var temp = file.name.split('.');
    var ext = temp.slice((temp.length-1),(temp.length));
    return '.' + ext[0];
}
function GetFileNameV(file) {
    var temp = file.name.split('.');
    var fname = temp.slice(0,-1).join('.');
    return fname;
}

/*----------------------------upload--------------------------*/
async function UploadProcessV(){
    var ImgToUpload = files[0];
    var ImgName = nameboxV.value + extlabV.innerHTML;

    const metaData = {
        contentType: ImgToUpload.type
    }

const storage = getStorage();

const storageRef = sRef(storage, "Videos/"+ImgName);

const UploasTask = uploadBytesResumable(storageRef, ImgToUpload, metaData);

UploasTask.on('state-changed', (snapshot)=>{
    var progress = (snapshot.bytesTransferred / snapshot.totalBytes)* 100;
    proglabV.innerHTML = "Upload "+ progress + "%";
},
(error) =>{
    alert("Erreur: la vidéo n'a pas pu être sauvegardée!");
},

()=>{
    getDownloadURL(UploasTask.snapshot.ref).then((downloadURL)=>{
        SaveURLtoFirestoreV(downloadURL);
    });
}
);
}
/*-----------------------------------------------*/
async function SaveURLtoFirestoreV(url) {
    var name = nameboxV.value;
    var ext = extlabV.innerHTML;
    const ho = new Date() ;
var Horaire = Timestamp.fromDate(ho);

    var ref = collection(db, "VideoLinks");

const docRef = await addDoc(
    ref,{
         Name: name,
         horaire: Horaire,
         URL: url
    }
)
}









upbtnV.onclick = UploadProcessV;










 
 




</script>
  </body>
</html>